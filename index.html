<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>80 лет освобождения Беларуси — Память и Победа</title>
  <meta name="description" content="Интерактивная карта освобождения Беларуси, лента времени, голоса очевидцев, архив и квизы." />

  <!-- Leaflet (карта) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    
    crossorigin=""
  ></script>

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header" role="banner">
  <a class="skip-link" href="#main">Пропустить к содержимому</a>
  <div class="brand">
    <img src="assets/logo.svg" alt="" aria-hidden="true" />
    <h1>80 лет освобождения Беларуси</h1>
    <p class="subtitle">Память. Ответственность. Единство.</p>
  </div>
  <nav class="main-nav" aria-label="Основная навигация">
    <ul>
      <li><a href="#map">Карта</a></li>
      <li><a href="#timeline">Лента времени</a></li>
      <li><a href="#voices">Голоса памяти</a></li>
      <li><a href="#archive">Архив</a></li>
      <li><a href="#quiz">Квизы</a></li>
      <li><a href="#wall">Стена памяти</a></li>
    </ul>
    <div class="lang-switch" role="group" aria-label="Выбор языка">
      <button data-lang="ru" aria-pressed="true">RU</button>
      <button data-lang="be">BE</button>
      <button data-lang="en">EN</button>
    </div>
  </nav>
</header>

<main id="main">
  <!-- Герой-блок -->
  <section class="hero" aria-label="Вступление">
    <div class="hero-content">
      <h2>От памяти к пониманию</h2>
      <p>Исследуйте путь к освобождению, слушайте голоса очевидцев и делитесь своей семейной историей.</p>
      <div class="cta">
        <a href="#map" class="btn primary">Исследовать карту</a>
        <a href="#voices" class="btn">Слушать голоса</a>
      </div>
    </div>
    <div class="hero-stats" aria-label="Ключевые факты">
      <div><strong>1944</strong><span>Минск освобождён 3 июля</span></div>
      <div><strong>80</strong><span>лет памяти и ответственности</span></div>
      <div><strong>100+</strong><span>событий на карте</span></div>
    </div>
  </section>

  <!-- Карта -->
  <section id="map" class="section">
    <header>
      <h2>Карта освобождения</h2>
      <p>Перемещайтесь по карте, выбирайте события и изучайте материалы.</p>
    </header>
    <div class="map-toolbar" role="region" aria-label="Фильтры карты">
      <label>Период:
        <input type="range" min="1941" max="1945" step="1" value="1944" id="yearRange" aria-label="Год" />
      </label>
      <fieldset>
        <legend>Слои</legend>
        <label><input type="checkbox" checked data-layer="fronts" /> Фронты</label>
        <label><input type="checkbox" checked data-layer="partisans" /> Партизаны</label>
        <label><input type="checkbox" checked data-layer="cities" /> Города</label>
      </fieldset>
      <input type="search" id="mapSearch" placeholder="Поиск события или места" aria-label="Поиск на карте" />
    </div>
    <div id="leafletMap" class="map" role="application" aria-label="Интерактивная карта"></div>
    <div id="mapSidebar" class="map-sidebar" aria-live="polite"></div>
  </section>

  <!-- Лента времени -->
  <section id="timeline" class="section">
    <header>
      <h2>Лента времени</h2>
      <p>Ключевые этапы освобождения и Победы.</p>
    </header>
    <div class="timeline-controls">
      <button class="btn" data-period="all">Все годы</button>
      <button class="btn" data-period="1941-1942">1941–1942</button>
      <button class="btn" data-period="1943">1943</button>
      <button class="btn" data-period="1944">1944</button>
      <button class="btn" data-period="1945">1945</button>
    </div>
    <div id="timelineGrid" class="timeline-grid" role="list"></div>
  </section>

  <!-- Голоса памяти -->
  <section id="voices" class="section">
    <header>
      <h2>Голоса памяти</h2>
      <p>Воспоминания очевидцев и фронтовиков.</p>
    </header>
    <div class="voices-list" role="list" id="voicesList"></div>
    <dialog id="voiceDialog" aria-label="Проигрыватель воспоминаний">
      <article>
        <button class="close" aria-label="Закрыть">&times;</button>
        <h3 id="voiceTitle"></h3>
        <audio id="voiceAudio" controls preload="metadata"></audio>
        <details>
          <summary>Транскрипт</summary>
          <div id="voiceTranscript"></div>
        </details>
      </article>
    </dialog>
  </section>

  <!-- Архив -->
  <section id="archive" class="section">
    <header>
      <h2>Архив</h2>
      <p>Документы, письма, фотографии и афиши.</p>
    </header>
    <div class="archive-grid" id="archiveGrid" role="list"></div>
  </section>

  <!-- Квизы -->
  <section id="quiz" class="section">
    <header>
      <h2>Квизы</h2>
      <p>Проверьте своё знание истории и откройте новые факты.</p>
    </header>
    <div class="quiz-card">
      <div id="quizQuestion" class="quiz-question" aria-live="polite"></div>
      <div id="quizAnswers" class="quiz-answers"></div>
      <button id="nextQuestion" class="btn" disabled>Дальше</button>
      <div id="quizProgress" class="quiz-progress" aria-live="polite"></div>
    </div>
  </section>

  <!-- Стена памяти -->
  <section id="wall" class="section">
    <header>
      <h2>Стена памяти</h2>
      <p>Оставьте историю вашей семьи — вместе мы сохраняем память.</p>
    </header>
<form id="memoryForm" enctype="multipart/form-data">
  <input type="text" name="name" placeholder="Ваше имя" required>
  <textarea name="text" placeholder="Ваш рассказ" required></textarea>
  
  <input type="file" name="photo" accept="image/*" id="photoInput">
  <div id="preview" style="margin:10px 0;"></div>
  
  <button type="submit">Отправить</button>
</form>

<div id="approvedPosts" class="posts-grid"></div>

<script>
async function loadApproved() {
  const res = await fetch('/api/posts?status=approved');
  const posts = await res.json();
  document.getElementById('approvedPosts').innerHTML = posts.map(p => `
    <div class="post-card">
      ${p.photo ? `<img src="${p.photo}" alt="">` : ''}
      <h3>${p.name}</h3>
      <p>${p.text}</p>
    </div>
  `).join('');
}

document.getElementById('memoryForm').addEventListener('submit', async e => {
  e.preventDefault();
  const formData = new FormData(e.target);
  await fetch('/api/posts', { method: 'POST', body: formData });
  e.target.reset();
  document.getElementById('preview').innerHTML = '';
  alert('Запись отправлена на модерацию');
});

document.getElementById('photoInput').addEventListener('change', e => {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = ev => {
      document.getElementById('preview').innerHTML = `<img src="${ev.target.result}" style="max-width:200px;border-radius:6px;">`;
    };
    reader.readAsDataURL(file);
  }
});

loadApproved();
</script>
  </section>
</main>

<footer class="site-footer" role="contentinfo">
  <p>Проект к 80‑летию освобождения Беларуси и Победы в Великой Отечественной войне.</p>
  <p>Партнёры: музеи, архивы, образовательные организации.</p>
</footer>

<script src="app.data.js"></script>
<script src="app.js"></script>
</body>
</html>


